<!DOCTYPE html> 
<html lang="en">
  <head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
	<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
	<meta name="description" content="SPSS Github Web Page"/>
	<meta name="author" content="IBM SPSS Group"/>
  
	<title>IBM  Predictive Extensions @ Github</title>
  
	<link href="./css/bootstrap.css" rel="stylesheet" type='text/css'/>
	<link href="./css/style.css" rel="stylesheet" type='text/css'/>
	<link id='pnext-css' href='./css/common.css' rel='stylesheet' type='text/css' media='screen' />
	<link id='pnext-css' href='./css/ibm-style.css' rel='stylesheet' type='text/css' media='screen' />
	<link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">

	<!-- DataTables CSS -->
	<link rel="stylesheet" type="text/css" href="./datatable/css/jquery.dataTables.css">
	
  </head>
  
  <body>
	<div class="navbar navbar-inverse navbar-fixed-top"> 
	  <!--  FROM THE COMMUNITY   -->
	  <div class="pn-dw-master cf" role="banner"> 
		<div class="fl">
		  <a href="http://www.ibm.com/developerworks/" class="pn-dw-fed-logo">
			<span class="pn-dw-ibm">IBM</span> developerWorks
		  </a>
		  <a class="pn-dw-fed-logo" href="/centers/">Developer Centers</a>
		</div>	
		<div class="fr">
		  <span id="pnext-dw-tab" class="pn-dw-tab">
			<a href="http://www.ibm.com/developerworks/" rel="external">
			  <img alt="dW" src="https://developer.ibm.com/predictiveanalytics/wp-content/themes/projectnext/css/dw-tab.png">
			</a>
		  </span>
		</div>
	  </div>

	  
	  <!--  FROM THE COMMUNITY   -->
	  <div id="pnext-top-menu" class="pn-top-menu links-top-menu" role="navigation" aria-label="Main navigation">
		<div class="flag">
		  <span class="link-home flag-img">
			<a rel="home" class="pn-nav-home" href="https://developer.ibm.com/predictiveanalytics">
			  <img class="pn-logo-image" src="https://github.com/aruizga7/aruizga7.github.io/blob/master/Logo.png?raw=true" alt="SPSS Predictive Analytics">
			</a>
		  </span>
		  <div class="pn-top-menu-container flag-bd flag-expand">
			<ul id="menu-main" class="menu">
			  <li id="menu-item-32" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-32"><a href="https://developer.ibm.com/predictiveanalytics/blog/">Blog</a></li>
			  <li id="menu-item-34" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-34"><a href="https://developer.ibm.com/predictiveanalytics/docs/home-2/">Docs</a></li>
			  <li id="menu-item-43" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-43"><a href="https://developer.ibm.com/predictiveanalytics/downloads/">Downloads</a></li>
			  <li id="menu-item-250" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-250"><a href="https://developer.ibm.com/predictiveanalytics/videos/">Videos</a></li>
			  <li id="menu-item-46" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-46"><a href="https://developer.ibm.com/predictiveanalytics/get-help/">Get Help</a></li>
			  <li id="menu-item-33" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-33"><a href="https://developer.ibm.com/predictiveanalytics/events-2/">Events</a></li>
			</ul>
		  </div>
		  <div class="flag-bd">
			<div class="pn-search">		
			  <form role="search" class="pn-search-form" method="get" id="searchbox_002602540803703215521:pmoyvjwf4xi" action="https://developer.ibm.com/predictiveanalytics/search/">
				<input value="more:more:next" name="hq" type="hidden">
				<label for="pnext-search-input" class="visuallyhidden">Search</label>
				<input placeholder="Search" required="" aria-required="true" id="pnext-search-input" class="pn-search-input pn-nav-search-input fl" name="visual_q" size="70" type="search">
				<input id="pnext-search-input-hidden" name="q" type="hidden">
				<input class="pn-search-submit" type="image" src="https://developer.ibm.com/predictiveanalytics/wp-content/themes/projectnext/css/searchicon.png" height="14" width="14" alt="Go" onclick="(function() {
						var search_input = $('#pnext-search-input');
						var search_actual = $('#pnext-search-input-hidden');
						search_actual.val(search_input.val()+' more:more:next');
						$('#searchbox_002602540803703215521:pmoyvjwf4xi').submit();
						return false;
					})()">
			  </form>
			</div>	
		  </div>  
		</div>
	  </div>
	</div>
  
	
	<!-- Main jumbotron for a primary marketing message or call to action -->
	<div class="main-field">
	  <!-- Side-bar Menu-->
	  <div class="leftsidebar-box">
		<dl class="home">
		  <dt id="home">
			<a href="http://ibmpredictiveanalytics.github.io/">
			  <i class="fa fa-home sidebar-title-icon"></i>
			  <span class="sub-menu-title sidebar-link">Home</span>
			</a>
		  </dt>
		</dl>
		<dl class="contribute">
		  <dt id="contribute">
			<a target="_blank" href="https://developer.ibm.com/predictiveanalytics/docs/spss-on-github/">
			  <i class="fa fa-user sidebar-title-icon"></i>
			  <span class="sub-menu-title sidebar-link">Contribute</span>
			</a>
		  </dt>
		  <dd style="font-style: italic;color:grey">Refined by</dd>
		</dl>
	  </div>
	  <!--Repository Field-->
	  <div class="repos-field">
		<div class="jumbotron">
			<div id="repos-title" style="padding-left: auto;padding-right: auto">
			  <h1 style="margin-left: auto;margin-right: auto">
				IBM <span style="font-weight:600; color:#00aed1">SPSS</span> Predictive Analytics Gallery
			  </h1>
			</div>
		</div>	
		<div class="container">
		  <div class="row">
			<div class="col-sm-12 col-md-12 col-lg-12">
			  <div id="wrapper">
				<input id="search" class="pn-search-input" placeholder="Search Our Repos ..." style='background-image:url("https://developer.ibm.com/predictiveanalytics/wp-content/themes/projectnext/css/searchicon.png");background-repeat: no-repeat;background-position:16rem;'>
				<div id="view-selector">
				  <div id="grid-view" style="margin-bottom: 0;margin-top: 0;display: inline">
					<button class="btn btn-default" type="button"  aria-expanded="true" style="background-color:#D8D8D8">
					<i  class="fa fa-th-large"></i>
					</button>
				  </div>
				  <div id="list-view" style="margin-bottom: 0;margin-top: 0;display: inline">
					<button class="btn btn-default" type="button"  aria-expanded="true">
					<i class="fa fa-th-list"></i>
					</button>
				  </div>
				</div>
				<hr class="hr-style">
			  </div>
			</div>
			<hr>
		  </div>
		</div>
		
	  </div>
	  <div id="space"></div>
	  <div id="footer">
		<p>Â© IBM 2015</p>
	  </div>
	</div>

    <!-- Placed at the end of the document so the pages load faster -->
    <script src="./js/jquery.js"></script>
    <script src="./js/bootstrap.min.js"></script>
    <script type="text/javascript" src="js/strftime.js"></script>
    <script type="text/javascript" src="orgs.js"></script>
	<script type="text/javascript" src="sidebar_info.js"></script>
	<script type="text/javascript" language="javascript" src="./datatable/js/jquery.dataTables.js"></script>
	<script type="text/javascript" language="javascript" src="./js/jquery.ba-resize.js"></script>
	<script type="text/javascript" language="javascript">
	  	
    allrepos = [];
	img_name = "default.png";
	isGridView = true;//default view type is grid view
	
    $(document).ready(function() {
	  //set search-box pos
	  function setSearchBoxPos(){
		var view_selector_mr = parseFloat($("#view-selector").css("margin-right"));
		var search_box_ml = parseFloat($("#search").css("margin-left"));
		$("#search").css("margin-left",(view_selector_mr*2)+search_box_ml);
	  }
	  
	  //sort the repos by pushed time as default
	  function sortByPushedTime(allrepos){
		var reg = /[^0-9]/ig;
		var repos = allrepos;
		for(var i=0; i<repos.length; i++){
		  for(var j=repos.length-1; j>i; j--){
			if (parseInt(repos[j].pushed_at.replace(reg,"")) > parseInt(repos[j-1].pushed_at.replace(reg,""))) {
			  temp = repos[j-1];
			  repos[j-1] = repos[j];
			  repos[j] = temp;
			}
		  }
		}
		return repos;
	  }
	  
	  function adjustBannerPos(){
		var navbar_h = $(".navbar").height();
		$(".main-field").css("margin-top", navbar_h);
	  }
	  
	  function getAllReposPadding(){
		var card_w = parseFloat($(".card").css("width"));
		var allrepos_w = parseFloat($("#allrepos").css("width"));
		var container_w = parseFloat($(".container").css("width"));
		var actual_repos_w = (allrepos_w<container_w?allrepos_w:container_w);
		var card_num = parseFloat(Math.floor(actual_repos_w/card_w));
		var padding = (actual_repos_w - card_w*card_num - 4*(card_num-1))/2;
		return padding || 0;
	  }
	  
	  function adjustReposFieldPos(){
		$(".repos-field").css("margin-left", $(".leftsidebar-box").width());
		$("#allrepos").css("padding-left", getAllReposPadding());
	  }
	  
	  function sortByPromotion(allrepos){
		var repos = [];
		for(var index in allrepos)
		{
		  if (allrepos[index].promotion == "Yes") 
			repos.push(allrepos[index]);

		}
		for(var index in allrepos)
		{
		  if (allrepos[index].promotion == "No") 
			repos.push(allrepos[index]);
		}
		return repos;
	  }
	  
	  function SidebarCheckboxState(sub_menu_name)
	  {
		this.sub_menu_name = sub_menu_name;
		this.sub_menu_key_list = [];
		this.sub_menu_value_list = [];
		this.pushSubItem = function(key,value){
		  this.sub_menu_key_list.push(key);
		  this.sub_menu_value_list.push(value);
		};
		this.setCheckState = function(key, check_state){
		  for(var i=0; i<this.sub_menu_key_list.length; i++){
			if (key === this.sub_menu_key_list[i]) {
			  this.sub_menu_value_list[i] = check_state;
			}
		  }
		};
	  }
	  
	  function getSoftwareIconName(software_name){
		var icon_name = "SPSS Software";
		$.each(sidebar_info, function(key, val){
		  if (val.menu_name.toLowerCase() == "software") {
			for (var index=0; index<val.sub_menu_name.length;index++) {
			  if (software_name == val.sub_menu_name[index]) {
				icon_name = val.sub_menu_icon_name[index];
			  }
			}
		  }
		});
		return icon_name;
	  }
	  
	  function addColNameForTable(){
		var $software_col = $("<th>").attr("id", "software-col").text("Software");
		var $name_col = $("<th>").attr("id", "name-col").text("Name");
		var $desc_col = $("<th>").attr("id", "desc-col").text("Description");
		var $cate_col = $("<th>").attr("id", "cate-col").text("Category");
		var $lang_col = $("<th>").attr("id", "lang-col").text("Language");
		var $repo_link_col = $("<th>").attr("id", "repo-link-col").text("Github Link");
		var $pushed_time = $("<th>").attr("id", "time-col").text("Time");
		return ($("<tr>").addClass("table_title").append($software_col).append($name_col).append($desc_col).append($cate_col).append($lang_col).append($repo_link_col).append($pushed_time));
	  }
	  
	  function createReposLink(repo_name, repo_id){
		var repos_url = "https://github.com/IBMPredictiveAnalytics/"+repo_name;
		  var $repos_link =  $("<input>").attr("type", "button").attr("id", repo_id).attr("onclick","window.open('"+repos_url+"')").attr("value","Go to Repository");
		  $repos_link.mouseover(function(){
			$(this).css("background-color", "#BDBDBD");
		  });
		  $repos_link.mouseout(function(){
			$(this).css("background-color", "#D8D8D8");
		  });
		  return $repos_link;
	  }

	  //list view
	  function addListRepos(allrepos)
	  {
		var searching_word = arguments[1] || "";
		$("#list_repos").empty();
		if ($.fn.dataTable.isDataTable($("#example"))) {
		  $("#example").destroy();
		}
		var $repos_table = $("<table>").attr("id","example").addClass("display").addClass("repos_table").appendTo("#list_repos");
		
		//table head
		var $table_head = $("<thead>").addClass("table-head").appendTo($repos_table);
		var $head_name_tr = addColNameForTable();
		$head_name_tr.appendTo($table_head);
		
		//table foot
		var $table_foot = $("<tfoot>").addClass("table-foot").appendTo($repos_table);
		var $foot_name_tr = addColNameForTable();
		$foot_name_tr.appendTo($table_foot);
		$(".table_title th").attr("rowspan",'1').attr("colspan",'1').attr("style","width:auto;font-size:14px");
		
		//table body
		var $table_body = $("<tbody>").addClass("table-body").appendTo($repos_table);
		for (i=0; i < allrepos.length; i++)
		{
		  repo = allrepos[i];
		  
		  if (repo.isShown == false) {
			  continue;
		  }
		  if (searching_word!="") {
			var val = $.trim(searching_word).replace(/ +/g, ' ').toLowerCase();
			var isContainSearchingWord = (~repo.software.toLowerCase().indexOf(val)) || (~repo.repository.toLowerCase().indexOf(val))
									  || (~repo.description.toLowerCase().indexOf(val)) || (~repo.category.toLowerCase().indexOf(val))
									  || (~repo.language.toLowerCase().indexOf(val));
			if(!isContainSearchingWord) {
			  continue;
			}
		  }
		  var container_w = parseFloat($(".container").css("width"));
		  var $software_item = $("<td>").attr("id", "software-item").text(repo.software);
		  var $name_item = $("<td>").attr("id", "name-item").text(repo.repository);
		  var $desc_item = $("<td>").attr("id", "desc-item").text(repo.description);
		  var $cate_item = $("<td>").attr("id", "cate-item").text(repo.category);
		  var $lang_item = $("<td>").attr("id", "lang-item").text(repo.language);
		  var $repo_link_item = $("<td>").attr("id", "repo-link-item");
		  var $repos_link = createReposLink(repo.repository, "repo-link-for-table")

		  $repos_link.appendTo($repo_link_item);
		  var $pushed_time = $("<td>").attr("id", "time-col").text(repo.pushed_at);
		  $("<tr>").attr("role","row").addClass("table_row").append($software_item).append($name_item).append($desc_item).append($cate_item).append($lang_item).append($repo_link_item).append($pushed_time).appendTo($table_body);
		}
				
		$('#example').DataTable( {
			"searching": false,
			//6th col is pushed_time, it is concealed 
			"columnDefs": [
			  {
				  "targets": [ 6 ],
				  "visible": false,
				  "searchable": false
			  },
			  {
				  "targets": [ 5 ],
				  "orderable": false
			  }
			],
			//by default, rows in list view are listed by descending sequence of pushed_time
			"aaSorting": [
			  [ 6, "desc" ]
			],
			"aLengthMenu": [[10,20,30,-1], ["10","20","30","all"]]
		});
		setFooterPos();
		
		//wehn selecting different page, the table length and the footer pos vary
		$("#list_repos").find('table').resize(function(){
		  setFooterPos();
		});
	  }
	  
	  //grid view
	  function addGridRepos(allrepos_info)
      {
		$("#allrepos").empty();
		for (i=0; i < allrepos_info.length; i++)
		{
		  repo = allrepos_info[i];
		  
		  if (repo.isShown == false) {
			  continue;
		  }
		  
		  var $item = $("<div>").addClass("card pin col-lg-3 col-md-4"+ (repo.language || '').toLowerCase()+ " "+repo.repository.toLowerCase()).appendTo("#allrepos");
		  var $top_layer = $("<div>").attr("id", "top-layer").appendTo($item);
		  
		  var $software_icon = $("<i>").addClass("fa").addClass(getSoftwareIconName(repo.software));
		  var $software_text = $("<span>").text(repo.software).attr("style","margin-left: 3px");
		  var $software_tag = $("<div>").attr("id", "repos-software").append($software_icon).append($software_text).appendTo($top_layer);
		  var $developer_tag = $("<div>").addClass("repos-tag").attr("id", "repos-developer").text(repo.provider).appendTo($top_layer);
		  
		  var $repos_name = $("<div>").attr("id", "repos-name").text(repo.repository).appendTo($item);
		  
		  var img_url = "https://raw.githubusercontent.com/IBMPredictiveAnalytics/"+repo.repository+"/master/"+img_name;
		  var $repo_img = $("<div>").attr("id", "repos-img").appendTo($item);
		  var $img = $("<img>").attr("alt","IBM SPSS").attr("src", img_url).appendTo($repo_img);
		  /*try{
			var $img = $("<img>").attr("alt","IBM SPSS").attr("src", img_url).appendTo($repo_img);
		  }catch(e){
			alert(e.message);
		  }*/
		
		  
		  //description length should not exceed 150 characters; otherwise there will be a tool tip poping up when mouse being over it
		  var desc_tip = repo.description;
		  var max_desc_leng = 150; 
		  if (repo.description.length>max_desc_leng) {
			desc_tip = '';
			for(var leng=max_desc_leng;leng>=0;leng--){
			  if (repo.description[leng] ==' ') {
				desc_tip = repo.description.substring(0,leng)+' ...';
				break;
			  }
			}
		  }
		  
		  var $repos_desc = $("<div>").attr("id", "repos-desc").text(desc_tip).appendTo($item);
		  if (repo.description.length>max_desc_leng) {
			$repos_desc.ToolTips(repo.description); 
		  }
		  
		  var lang_list = repo.language.split(',');
		  var $repos_lang = $("<div>").attr("id", "repos-lang").attr("style", "margin-bottom:5px").appendTo($item);
		  for(var lang_index=0;lang_index<lang_list.length;lang_index++)
		  {
			$("<div>").addClass("repos-tag").attr("id", "repos-language").text($.trim(lang_list[lang_index])).appendTo($repos_lang);
		  }
				  
		  var cate_list = repo.category.split(',');
		  var $repos_cate = $("<div>").attr("id", "repos-cate").attr("style", "margin-bottom:5px").appendTo($item);
		  for(var cate_index=0;cate_index<cate_list.length;cate_index++)
		  {
			$("<div>").addClass("repos-tag").attr("id", "repos-category").text($.trim(cate_list[cate_index])).appendTo($repos_cate);
		  }
		  $("<div>").attr("style","clear:both").appendTo($repos_cate);

		  var $repos_link = createReposLink(repo.repository, "repos-link");
		  $repos_link.appendTo($item)
		}
		
		//to deal that the text of repos-tag in moz is not at vertical center
		var rMSIE = /(msie\s|trident.*rv:)([\w.]+)/;
		var rFirefox = /(firefox)\/([\w.]+)/;
		var ua = navigator.userAgent.toLowerCase();
		var isIE =  rMSIE.exec(ua);
		var isFirefox = rFirefox.exec(ua);
		if (isIE || isFirefox) {
			$("#allrepos div[id='repos-language']").css("padding-top","2px");
			$("#allrepos div[id='repos-category']").css("padding-top","2px");
		}
		
		adjustReposFieldPos();
		setFooterPos();
		adjustBannerPos();
		$(window).load(function(){
		  setReposHeight();
		  setReposWidth();
		});
	  }
	  
	  $(window).resize(function () {
		  adjustBannerPos();
		  adjustReposFieldPos();
		});
	  
	  function getMaxHeightForEachDiv(div_id, attr){
		var max_height = parseFloat($("#allrepos div["+attr+"='"+div_id+"']:eq(0)").css("height"));
		for(var i=0;i<$("#allrepos div["+attr+"="+div_id+"]").length;i++){
		  if (max_height < parseFloat($("#allrepos div["+attr+"="+div_id+"]:eq("+i+")").css("height"))) {
			max_height = parseFloat($("#allrepos div["+attr+"="+div_id+"]:eq("+i+")").css("height"));
		  }
		  
		}
		return max_height;
	  }
	  
	  $.fn.ToolTips=function(tip_text){ 
		var div = document.createElement("div"); 
		div.style.cssText = 'text-align:left;width:300px; line-height:15px; border:solid 1px #000000; background-color:#F2F2F2; padding:6px 10px; font-size:10px;position:absolute;border-radius: 0.5rem'; 
		div.onclick=function(){$(div).remove();}; 
		$(this).mouseover(function(e){ 
		  if(!e){e=window.event;} 
		  div.innerHTML= tip_text; 
		  var doc = document.documentElement ? document.documentElement : document.body; 
		  div.style.left=(e.clientX+doc.scrollLeft + 5)+"px"; 
		  div.style.top=(e.clientY+doc.scrollTop + 5)+"px"; 
		  document.body.appendChild(div);
		}).mouseout(function(){ 
		  $(div).remove(); 
		}); 
	  }
	  
	  function setFooterPos(){
		var sidebar_h = $(".leftsidebar-box").height();
		var screen_h = document.documentElement.clientHeight - $(".navbar").height();
		var scroll_top = document.documentElement.scrollTop == 0 ? document.body.scrollTop : document.documentElement.scrollTop;
		var repos_field_h = $(".repos-field").height();

		if (sidebar_h>repos_field_h) {
		  $("#space").css("height",sidebar_h-repos_field_h-$("#footer").height());
		}
		else{
		  $("#space").css("height", 100);
		}
		
		$("#footer").css("margin-left", "16%");
	  }
	  
	  function getMaxWidth(id){
		var max_width = parseFloat($("#allrepos div[id='"+id+"']:eq(0)").css("width"));
		for(var i=0;i<$("#allrepos div[id='"+id+"']").length;i++){
		  if (max_width < parseFloat($("#allrepos div[id='"+id+"']:eq("+i+")").css("width"))) {
			max_width = parseFloat($("#allrepos div[id='"+id+"']:eq("+i+")").css("width"));
		  }
		}
		return max_width == NaN?0:max_width;
	  }
	  
	  function setReposHeight(){
		var name = getMaxHeightForEachDiv('repos-name','id');
		$("#allrepos div[id='repos-name']").css("height",name);
		
		var desc = getMaxHeightForEachDiv('repos-desc','id');
		$("#allrepos div[id='repos-desc']").css("height",desc);
		
		var cate = getMaxHeightForEachDiv('repos-cate','id');
		$("#allrepos div[id='repos-cate']").css("height",cate);
		
		var lang = getMaxHeightForEachDiv('repos-lang','id');
		$("#allrepos div[id='repos-lang']").css("height",lang);
		
		var img = getMaxHeightForEachDiv('repos-img','id');
		$("#allrepos div[id='repos-img']").css("height",img);

		var tot_height = parseFloat(name)+parseFloat(desc)+parseFloat(cate)+parseFloat(lang)+parseFloat(img)
						+parseFloat($("#top-layer").css("height"))
						/*+parseFloat($("#repos-img").css("height"))*/
						+parseFloat($("#repos-link").css("height"))+90;//set the amount of the space between different div as 100px
		$(".card").css("height",tot_height+'px');

	  }
	  
	  function setReposWidth(){
		var img_max_width = getMaxWidth("repos-img");
		var repos_name_max_width = getMaxWidth("repos-name");
		var repos_top_layer_max_width = getMaxWidth("top-layer");
		
		var max_width = img_max_width>repos_name_max_width?img_max_width:repos_name_max_width;
		max_width = max_width>repos_top_layer_max_width?max_width:repos_top_layer_max_width;
		
		var card_w = parseFloat(max_width)+20;
		$(".card").css("width", card_w+'px');
	  }
	  
	  function delLinkSymbol(str)
	  {
		if (str.indexOf('-') >= 0 || str.indexOf('_') >= 0) {
		  str = str.replace('_', ' ');
		  str = str.replace('-', ' ');
		}
		return str;
	  }
	  
	  function getShowingReposNum(){
		var ShowingNum = 0;
		$.each(allrepos, function(index, repo){
		  if (repo.isShown == true) {
			ShowingNum++;
		  }
		});
		return ShowingNum;
	  }
	  
	  function addRepos(orgs, repos, page) {
		$.getJSON("./resbundles/index_for_web.json", function(info){
			var index_info = info.repository_index;
			if (index_info && index_info.length > 0) {
			  allrepos = allrepos.concat(index_info);
			
			  $.each(allrepos, function (i, repo) {//repo is ith item in repos
				repo.isShown = true;
			  });
			  
			  //two sorting principle:
			  //1. by pused time; 2. by promotion 
			  allrepos = sortByPushedTime(allrepos);
			  allrepos = sortByPromotion(allrepos);
			  
			  addGridRepos(allrepos);
			  addListRepos(allrepos);
			  $("#list_repos").hide();
			}
			
			var side_bar_checkbox_state = {};
			createSideBar(side_bar_checkbox_state);
			filterCheckbox(allrepos,side_bar_checkbox_state);
			
			$("#grid-view button").click(function(){
			  isGridView = true;
			  $("#search").trigger("keyup");
			  $("#list-view button").css("background-color","white");
			  $("#grid-view button").css("background-color","#D8D8D8");
			  $("#list_repos").hide();
			  $("#allrepos").show();
			  if (!getShowingReposNum()) {
				$("#no_repo_msg_div").show();
			  }
			});
			$("#list-view button").click(function(){
			  isGridView = false;
			  $("#search").trigger("keyup");
			  $("#list-view button").css("background-color","#D8D8D8");
			  $("#grid-view button").css("background-color","white");
			  $("#allrepos").hide();
			  $("#list_repos").show();
			  $("#no_repo_msg_div").hide();
			});
		});
	  }
	  
	  //Create side-bar menu
	  //the check state of each checkbox is saved in side_bar_checkbox_state
	  function createSideBar(side_bar_checkbox_state){
		var i=0;
		$.each(sidebar_info, function(key, val){
		  var $cur_dl = $("<dl>").addClass(val.menu_name.toLowerCase()+"-filter").appendTo(".leftsidebar-box");
		  var $menu_icon = $("<i>").addClass("fa").addClass(val.menu_icon_name).addClass("sidebar-title-icon");
		  var $text = $("<span>").addClass("sub-menu-title").text(delLinkSymbol(val.menu_name));
		  var $cur_a = $("<a>").attr("href", "#").append($menu_icon).append($text); 
		  var $cur_dt = $("<dt>").attr("id",val.menu_name.toLowerCase()).append($cur_a).appendTo($cur_dl);
		  
		  
		  var parent_key = val.menu_name.toLowerCase();
		  var item = new SidebarCheckboxState(parent_key);
		  
		  for(var index in val.sub_menu_name)
		  {
			var $cur_input = $("<input>").attr("type","checkbox").attr("state","false").attr("style", "float:right; margin-right:10px;color:#809697").attr("key",parent_key).attr("value",val.sub_menu_name[index]);
			var $sub_text = $("<span>").addClass("sub-menu-text").text(delLinkSymbol(val.sub_menu_name[index]));
			var $sub_menu_icon = $("<i>").attr("id","icon-name").addClass("fa").addClass(val.sub_menu_icon_name[index]).addClass("sidebar-sub-icon");
			var $cur_dd = $("<dd>").attr("id","sidebar-checkbox").append($sub_menu_icon);
			$cur_dd.append($sub_text).append($cur_input).appendTo($cur_dl);
			item.pushSubItem(val.sub_menu_name[index],"false");
			
		  }
		  side_bar_checkbox_state[i] = item;
		  i += 1;  
		});	
	  }

	  function toggleCheckbox(cur_state){
		if (cur_state == "true") {
		  return "false";
		}else{
		  return "true";
		}
	  }
	  
	  function getLowerCaseArray(array){
		var lowerCaseArray = [];
		for(index in array){
		  lowerCaseArray.push(array[index].toLowerCase());
		}
		return lowerCaseArray;
	  }
	  
	  //sidebar checkbox filter function
	  function filterCheckbox(allrepos_info, side_bar_checkbox_state){
		$(".leftsidebar-box").delegate("input", "click", function(){
			$(this).attr("state", toggleCheckbox($(this).attr("state")));
			var cur_checked_state = $(this).attr("state");
			var filter_key = $(this).attr("key");
			var filter_value = $(this).attr("value");
			
			$.each(side_bar_checkbox_state, function(sidebar_key, item){
				if (filter_key==item.sub_menu_name)
					item.setCheckState(filter_value, cur_checked_state);
			});
			
			var ZeroCheckedMenuList = getZeroCheckedMenuList();

			if (isNeedResetRepos()) {
				setAllReposIsShown(allrepos_info, true);
			}
			
			else{
			  setAllReposIsShown(allrepos_info,false);
			  
			  var is_repo_shown = true;
			  $.each(allrepos_info, function(repo_key, repo){
				  is_repo_shown = true;
			  	  var is_repo_checked = false;
				  
				  $.each(side_bar_checkbox_state, function(sidebar_key, item) {
					  is_repo_checked = false;
					  if ($.inArray(item.sub_menu_name, ZeroCheckedMenuList)>=0) {
						  return true;
					  }
					  
					  var checked_list = [];	  
					  for(var i=0; i<item.sub_menu_key_list.length;i++){
						  if (item.sub_menu_value_list[i] == "true") {
							  checked_list.push(item.sub_menu_key_list[i]);
						  }
					  }
					  
					  $.each(checked_list, function(checked_key, checked_item){
						  var item_list = repo[item.sub_menu_name].split(',');
						  for(var item_index in item_list)
						  {
							item_list[item_index] = $.trim(item_list[item_index]);
						  }
						  
						  if ($.inArray(checked_item.toLowerCase(), getLowerCaseArray(item_list))>=0) {
							is_repo_checked  = true;
							return false;
						  }
					  });
					  
					  if (!is_repo_checked) {
						  is_repo_shown = false;
						  repo["isShown"] = false;
						  return false;
					  }
				  });
				  
				  if (is_repo_shown) {
					  repo["isShown"] = true;
				  }
			  });
			}
			
			var hasResult = false;
			$.each(allrepos_info, function(repo_key, repo_item){
			  if (repo_item["isShown"] == true){
				$("#allrepos div[class*='card']:eq("+repo_key+")").show();
				hasResult = true;
			  }else{
				$("#allrepos div[class*='card']:eq("+repo_key+")").hide();
			  }
			});
			
			if (!hasResult && isGridView) {
			  $("#no_repo_msg_div").show();
			}
			else{
			  $("#no_repo_msg_div").hide();
			}
			addListRepos(allrepos_info);
			$("#search").trigger("keyup");
		});
	  }
	  
	  function setAllReposIsShown(repos, isShown){
		$.each(repos, function(repo_key, repo){
		  repo.isShown = isShown;
		});
	  }
	  
	  function isNeedResetRepos(){
		var isChecked = true;
		$(".leftsidebar-box input[type='checkbox']").each(function(){
		  if ($(this).attr("state") == "true") {
			isChecked = false;
		  }
		});
		return isChecked;
	  }
	  
	  function isItemChecked(sub_menu_name){
		var isChecked = false;
		$(".leftsidebar-box input[key='"+sub_menu_name+"']").each(function(){
		  if ($(this).attr("state") == "true") {
			isChecked = true;
		  }
		});
		return isChecked;
	  }
	  
	  function getZeroCheckedMenuList(){
		  var ZeroCheckedMenuList = [];
		  $(".leftsidebar-box dl[class$='filter']").each(function(){
			  var isNochecked = true;
			  $(this).find("input").each(function(){				
				  if ($(this).attr("state") == "true") {
					  isNochecked = false;					  
					  return false;
				  }
			  });
			  if (isNochecked) {
				ZeroCheckedMenuList.push($(this).find("input").attr("key"));
			  } 
		  });
		  return ZeroCheckedMenuList;
	  }	  
	  
	  function adjustSidebarPos() {
		var sidebar_h = $(".leftsidebar-box").height();
		var screen_h = document.documentElement.clientHeight - $(".navbar").height();
		var scroll_top = document.documentElement.scrollTop == 0 ? document.body.scrollTop : document.documentElement.scrollTop;
		var repos_field_h = parseFloat($(".repos-field").css("height"));
		$(".leftsidebar-box").css("height", sidebar_h);

		if (sidebar_h<repos_field_h && sidebar_h>screen_h && (sidebar_h-screen_h)<=scroll_top) {
			$(".leftsidebar-box").css("position", "fixed");
			$(".leftsidebar-box").css("bottom", "0");
			$(".leftsidebar-box").css("left", "0");
			$(".repos-field").css("margin-left", $(".leftsidebar-box").width());	
		}else{
		  $(".leftsidebar-box").css("position", "static");
		}
	  }
	  
	  $(window).scroll(function(){		
		adjustSidebarPos();
	  });
	  
	  $('#search').keyup(function() {
		var val = $.trim($(this).val()).replace(/ +/g, ' ').toLowerCase();
		if (isGridView) {
		  $(".card").filter(function(){
			var repo_index = $(".card").index($(this));
			return (allrepos[repo_index]["isShown"] != false);
		  }).show()
		  .filter(function(){
			var text = $(this).text().replace(/\s+/g, ' ').toLowerCase();
			var hasSearchWord = ~text.indexOf(val);
			return !hasSearchWord;
		  }).hide();
		  
		  var shownReposNum = 0;
		  $.each($(".card"), function(repo_index, repo){
			if($(this).css("display") != "none" && allrepos[repo_index]["isShown"] != false)
			  shownReposNum++;
		  });
		  if(!shownReposNum) {
			$("#no_repo_msg_div").show();
		  }else{
			$("#no_repo_msg_div").hide();
		  }
		}else{
		  addListRepos(allrepos, val);
		}
	  
  
		// ---------------------------------
		// Google Analytics Event Tracking
		// 
		// 
		// usage: add the following attributes to links you want to track:
		//   data-analytics-category=""    REQUIRED  String   Typically the object that was interacted with (e.g. button)
		//   data-analytics-action=""      REQUIRED  String   The type of interaction (e.g. click)
		//   data-analytics-label=""       OPTIONAL  String   Useful for categorizing events (e.g. nav buttons)
		//   data-analytics-value=""       OPTIONAL  Integer  Values must be non-negative. Useful to pass counts (e.g. 4 times)
		//
		// Those are the suggested usages, but you can use the attributes how you want
		// see https://developers.google.com/analytics/devguides/collection/analyticsjs/events for more details
		// 
		// EXAMPLE:
		// <a href="http://ibm.com" data-analytics-category="Leadspace button" data-analytics-action="To ibm.com">Off you go!</a>
		// ---------------------------------
		
		$('body').on('click', 'a[data-analytics-category][data-analytics-action]', function(e){
	
		  // No analytics? Bail.
		  if ( ! window.ga )
			return;
		  
		  // for links to external sources, we need a tiny delay to have a little extra time to send to Google's servers before unload
		  // 200ms is about right for enough time
		  if (this.hostname && this.hostname !== location.hostname) {
			// Stop the link action
			e.preventDefault();
			
			// setTimeout callback is called in the window scope, so cache the url from the link now
			var url = this.href;
			
			// in 200ms, off you go
			setTimeout(function(){
			  document.location = url;        
			},200);
		  }
		  
		  var $el = $(this),
			  data = {'hitType': 'event'}; // make a new data object 
			  
		  // category (required string)
		  data['eventCategory'] =  $el.attr('data-analytics-category');
		  
		  // action (required string)
		  data['eventAction'] = $el.attr('data-analytics-action');
		  
		  // label (optional string)
		  if ( $el.attr('data-analytics-label') )
			data['eventLabel'] = $el.attr('data-analytics-label');
	
		  // value (optional int)
		  if ( $el.attr('data-analytics-value') )
			data['eventValue'] = parseInt( $el.attr('data-analytics-value') );
	
		  // send the data
		  ga('send', data);
		  
		});
  
	  });  
	  
	  //function is executed from this line
	  //Create Repository Field
	  
	  var $grid_item = $("<div id='allrepos'>").attr("display", "block").appendTo("#wrapper");        //grid view
	  var $list_item = $("<div id='list_repos'>").attr("display", "block").appendTo("#wrapper");      //list view
	  var $no_repo_msg = $("<span>").text("No items found. Please change the filter on the sidebar.");
	  $("<div id='no_repo_msg_div'>").attr("style","text-align:center;font-style: italic;font-size:16px;").append($no_repo_msg).appendTo("#wrapper").hide();
	  $list_item.hide();	  
	  //orgs has been defined in orgs.js
	  for (var r in orgs)
      {
		addRepos(orgs[r]);
	  }
	  setSearchBoxPos();
	  $("<div>").addClass("separator").appendTo("#wrapper");
	  alert($(window).width());
	});

	</script>
  </body>
</html>
